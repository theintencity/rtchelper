!function(){"undefined"!=typeof chrome&&chrome.runtime&&chrome.runtime.id&&ace.config.set("loadWorkerFromBlob",!1),window.addEventListener("load",()=>{{let h="chrome-extension:"==window.location.protocol;h&&document.body.setAttribute("extension","");const e=m("div.content > div.tab[tab]").map(e=>{var t=e.getAttribute("hide"),n=e.getAttribute("name"),a=e.hasAttribute("noasync");return{hide:t,tab:e.getAttribute("tab"),name:n,title:(b("div.help > div.title",e)||{}).innerText,static:!!e.className.match(/\bstatic\b/),div:e,noasync:a}}),t=[].concat(e,c),a=(c.splice(0,c.length,...t),c.filter(e=>!e.static).forEach(e=>{const t=b("template#tab-item"),n=t.content.cloneNode(!0),a=n.querySelector("div:nth-child(1)"),i=n.querySelector("div:nth-child(2)");var r=n.querySelector(`div[tab="${e.tab}"]`),o=e.hide&&(h&&"extension"==e.hide||!h&&"extension"!=e.hide),s=(a.setAttribute("tab",e.tab),a.setAttribute("title",(e.title||"").replace(/\n/,"<line>\n").replace(/\n\s*/g," ").replace(/<line>\s/,"\n\n")),a.innerText=e.name,o||b("div.nav").insertBefore(a,b("div.nav > div.last")),i.setAttribute("tab",e.tab),!!e.div);if(s?(i.replaceChild(e.div.querySelector("div.help"),i.querySelector("div.help")),e.noasync&&i.setAttribute("noasync","")):(b("div.title",i).innerText=e.title,b("div.desc",i).innerText=e.desc),b("div.title",i).onclick=e=>{const t=e.currentTarget.parentNode;t.hasAttribute("expanded")?t.removeAttribute("expanded"):t.setAttribute("expanded",""),setTimeout(()=>{const e=t.parentNode.editor;e&&e.resize()},500)},r&&[].slice.call(r.children).forEach(e=>{i.appendChild(e)}),s?b("div.content").replaceChild(i,e.div):b("div.content").insertBefore(i,b("div.content > div.tab.last")),!o){const d=b('div.tab[tab="help"] ol.topics'),c=document.createElement("li"),l=(c.innerText=e.title,c.setAttribute("tab",e.tab),d.appendChild(c),c.onclick=e=>{var e=e.currentTarget.getAttribute("tab");const t=b(`div.nav > div[tab="${e}"]:not([hidden])`);t&&(t.click(),e=b(`div.tab[tab="${e}"]`),b("div.help",e).hasAttribute("expanded")||b("div.help > div.title",e).click())},b('div.tab[tab="help"] table.topicdesc tbody')),u=document.createElement("tr"),p=document.createElement("td"),v=(p.innerText=e.name,u.appendChild(p),document.createElement("td")),m=(b("div.desc",i).innerText||"").split(".")[0];v.innerText=e.title+". "+m.trim(),u.appendChild(v),l.appendChild(u)}}),b("div.nav").onscroll=e=>{var t=b("div.nav"),n=0<t.scrollLeft,t=t.scrollLeft+t.offsetWidth<t.scrollWidth;b("div.nav").setAttribute("scroll",n&&t?"both":n?"left":t?"right":"")});b("div.nav").style.setProperty("scroll-behavior","auto"),a(),setTimeout(()=>{b("div.nav").style.setProperty("scroll-behavior","")},500),b("div.nav > div.before").onclick=e=>{const t=b("div.nav");t.scrollLeft=Math.max(0,t.scrollLeft-Math.min(t.offsetWidth,200)),a()},b("div.nav > div.after").onclick=e=>{const t=b("div.nav");t.scrollLeft=Math.min(t.scrollWidth,t.scrollLeft+Math.min(t.offsetWidth,200)),a()},m("div.nav > div").filter(e=>e.hasAttribute("tab")).forEach(e=>{e.onclick=e=>{b("body").getAttribute("selected");e=e.currentTarget.getAttribute("tab");b("body").setAttribute("selected",e),b(`div.nav > div[tab="${e}"]`).scrollIntoView({inline:"center"});const t=b(`div.tab[tab="${e}"]`);t&&t.editor&&t.editor.resize(),dispatchEvent(Object.assign(new Event("tabchange"),{selected:b("body").getAttribute("selected")}))}}),m("div.content > div.tab").forEach((a,e)=>{const i=a.getAttribute("tab"),t=b("div.editor",a);if(t){t.id||(t.id="editor-"+e);const r=a.editor=ace.edit(t.id);r.setTheme("ace/theme/clouds"),r.session.setMode("ace/mode/javascript"),r.session.setUseWrapMode(!0),r.setHighlightActiveLine(!1),r.session.on("changeMode",()=>{r.session.$worker&&r.session.$worker.send("changeOptions",[{"-W025":!1,esversion:8}])},1e3);e=()=>{k(a,!0,!0),b("select",a).changing||!function(e,t){const n=b("input.caption",e),a=b("select",e),i=a.selectedOptions[0];t?T&&!e.hasAttribute("editing")&&(e.setAttribute("editing",""),!n.value&&0<a.selectedIndex&&(t=a.value,n.value=("Saved"==i.getAttribute("source")?"":"(Edit) ")+t)):e.hasAttribute("editing")&&(e.removeAttribute("editing"),n.value="");return i&&"Saved"==i.getAttribute("source")}(a,!0)&&0<b("select",a).selectedIndex&&(b("select",a).selectedIndex=0)};r.on("change",e),r.on("paste",e),b("button.save",a).onclick=e=>{const t=r.getValue();var n;(a.hasAttribute("noasync")||void 0)&&t&&t.match(/^async\s+function\b/)?(console.warn("async function is not allowed here"),r.selection.setRange(new ace.Range(0,0,0,6))):(n=a.hasAttribute("editing")&&a.querySelector("input.caption").value||void 0,n={type:i,text:t,caption:n},dispatchEvent(Object.assign(new Event("data"),{data:n})),setTimeout(()=>{k(a,!1)}))}}});{const l=b('div.tab[tab="usercontrols"]'),u=b("div.item.add",l);b("button.add",l).onclick=e=>{var t=b('input[name="varname"]',u).value,n=b('select[name="type"]',u).value;const a=b('input[name="pattern"]',u).value;var i=b('input[name="readonly"]',u).checked,r=b('input[name="label"]',u).value;let o="";"boolean"==n?o=!1:"number"==n?o=0:"range"==n?(s=a.match(/^(\-?\d+)\-(\-?\d+)/),o=(o=s&&"0"!=s[1]?(parseFloat(s[1])+parseFloat(s[2]))/2:o)||0):"selection"==n&&(o=a.split("|")[0]);var s={varname:t,value:o,type:n,pattern:a,readonly:i,label:r};const d=function(t){let n;t.varname&&t.varname.match(/^[a-zA-Z][a-zA-Z_0-9]*$/)?"boolean"==t.type&&"true|false"!=t.pattern?n="pattern: invalid pattern for boolean":"selection"!=t.type||t.pattern.match(/^[\w\s]+(\|[\w\s]+)*$/)?"range"!=t.type||t.pattern.match(/^(\-?\d+)\-(\-?\d+)(\/\d+)?$/)?t.label&&!t.label.match(/^[\w\s,\.\:\-]+$/)?n="label: invalid characters in description":"event"==t.type&&t.pattern&&(n="pattern: not allowed for event"):n="pattern: invalid pattern for range":n="pattern: invalid pattern for selection":n="varname: invalid var name";if(!n&&t.pattern&&("string"==t.type||"number"==t.type))try{var e=t.pattern.replace(/^\^/,"").replace(/\$/,"");new RegExp(`^${e}$`)}catch(e){console.warn("incorrect regular expression "+t.pattern,e),n="pattern: incorrect regular expression"}return n}(s);if(d){console.warn("error",d);const c=d.split(":")[0];u.setAttribute("error",c),setTimeout(()=>{u.getAttribute("error")===c&&u.removeAttribute("error")},5e3)}else L(s,!0),b('input[name="varname"]',u).value=b('input[name="pattern"]',u).value=b('input[name="label"]',u).value="",b('select[name="type"]',u).selectedIndex=0,b('input[name="readonly"]',u).checked=!1,u.removeAttribute("dirty"),l.setAttribute("dirty","")},b("button.save",l).onclick=e=>{var t;!function(){var e=b('div.tab[tab="usercontrols"]'),t=m("div.item[varname]",e).filter(e=>e.hasAttribute("error")||void 0===e.data.value);if(t.length)return;const n=m("div.item[varname]",e).map(e=>e.data.varname),a={},i=(n.forEach(e=>{a[e]=(a[e]||0)+1}),Object.keys(a).filter(e=>1<a[e]));if(0<i.length)return void m("div.item[varname]",e).filter(e=>0<=i.indexOf(e.data.varname)).forEach(e=>{e.setAttribute("error","varname"),setTimeout(()=>{e.removeAttribute("error")},3e3)});t=m("div.item[varname",e).map(e=>e.data);0<t.length&&((M=M||{}).variables=t);!M||M.variables&&M.variables.length||(M=void 0);return 1}()||(t={type:"usercontrols",text:M},dispatchEvent(Object.assign(new Event("data"),{data:t})),setTimeout(()=>{k(l,!1)}))},b('input[name="varname"]',u).onkeyup=e=>{setTimeout(()=>{b('input[name="varname"]',u).value?u.setAttribute("dirty",""):u.removeAttribute("dirty")})},b('select[name="type"]',u).onchange=e=>{e=e.currentTarget.value;b('input[name="pattern"]').value="boolean"==e?"true|false":"selection"==e?"first|second|third":"range"==e?"0-100":"",b('input[name="pattern"]').disabled="event"==e}}{const p=b('div.tab[tab="settings"]'),v=c.map(e=>e.name).join(","),s=(b("h2",p).onclick=e=>{p.hasAttribute("verbose")?p.removeAttribute("verbose"):p.setAttribute("verbose","")},b("select.fontsize",p).onchange=b('input.tabswrap[value="true"]',p).onclick=b("textarea.tabslist",p).onchange=b("textarea.tabslist",p).onkeyup=b("textarea.urls",p).onchange=b("textarea.urls",p).onkeyup=b("textarea.savestats",p).onchange=b("textarea.savestats",p).onkeyup=b("textarea.ffmpeg",p).onchange=b("textarea.ffmpeg",p).onkeyup=e=>{k(p,!0)},b("textarea.tabslist",p).onfocus=e=>{""===e.currentTarget.value&&(e.currentTarget.value=v)},b("textarea.tabslist",p).onblur=e=>{e.currentTarget.value==v&&(e.currentTarget.value="")},b('input.mode[value="open"]',p).onclick=b('input.mode[value="open-pinned"]',p).onclick=b('input.mode[value="open-popup"]',p).onclick=b('input.mode[value="inline"]',p).onclick=b('input.mode[value="inline-float"]',p).onclick=e=>{k(p,!0);var t=e.currentTarget.getAttribute("value");e.currentTarget.checked?("open"==t||"open-pinned"==t||"open-popup"==t?b('input.mode[value="inline"]',p).checked=b('input.mode[value="inline-float"]',p).checked=!1:"inline"!=t&&"inline-float"!=t||(b('input.mode[value="open"]',p).checked=b('input.mode[value="open-pinned"]',p).checked=!1,b('input.mode[value="open-popup"]',p).checked=!1),"open-pinned"==t?(b('input.mode[value="open"]',p).checked=!0,b('input.mode[value="open-popup"]',p).checked=!1):"open-popup"==t?(b('input.mode[value="open"]',p).checked=!0,b('input.mode[value="open-pinned"]',p).checked=!1):"inline-float"==t&&(b('input.mode[value="inline"]',p).checked=!0)):"open"==t?(b('input.mode[value="open-pinned"]',p).checked=!1,b('input.mode[value="open-popup"]',p).checked=!1):"inline"==t&&(b('input.mode[value="inline-float"]',p).checked=!1)},b('input.mode-suffix[value="left"]',p).onclick=b('input.mode-suffix[value="bottom"]',p).onclick=e=>{k(p,!0);var t=e.currentTarget.getAttribute("value");e.currentTarget.checked&&("left"==t?b('input.mode-suffix[value="bottom"]',p).checked=!1:"bottom"==t&&(b('input.mode-suffix[value="left"]',p).checked=!1))},b('input.theme[value="light"]',p).onclick=b('input.theme[value="dark"]',p).onclick=e=>{k(p,!0),e.currentTarget.checked&&("light"==e.currentTarget.getAttribute("value")?b('input.theme[value="dark"]',p).checked=!1:b('input.theme[value="light"]',p).checked=!1)},b('input.scripts[value="edit"]',p).onclick=b('input.scripts[value="named"]',p).onclick=e=>{k(p,!0),e.currentTarget.checked?"named"==e.currentTarget.getAttribute("value")&&(b('input.scripts[value="edit"]',p).checked=!0):"edit"==e.currentTarget.getAttribute("value")&&(b('input.scripts[value="named"]',p).checked=!1)},b('input.strict[value="always"]',p).onclick=b('input.strict[value="external"]',p).onclick=e=>{k(p,!0),e.currentTarget.checked&&("always"==e.currentTarget.getAttribute("value")?b('input.strict[value="external"]',p).checked=!1:b('input.strict[value="always"]',p).checked=!1)},m("input.editor",p).forEach(e=>{e.onclick=e=>{k(p,!0)}}),b("button.reset",p).onclick=e=>{k(p,!0),g({})},b("button.save",p).onclick=e=>{b("textarea.tabslist").blur(),b("textarea.urls").blur(),b("textarea.savestats").blur(),b("textarea.ffmpeg").blur();let t=b("textarea.tabslist",p).value||void 0;t===v&&(t=void 0);var n=b("textarea.urls",p).value||void 0,a=b("textarea.savestats",p).value||void 0,i=b("textarea.ffmpeg",p).value||void 0,r=b("select.fontsize",p).value||void 0;let o=b('input.mode[value="open-pinned"]',p).checked?"open-pinned":b('input.mode[value="open-popup"]',p).checked?"open-popup":b('input.mode[value="open"]',p).checked?"open":b('input.mode[value="inline-float"]',p).checked?"inline-float":b('input.mode[value="inline"]',p).checked?"inline":void 0;o&&o.startsWith("inline")&&((s=b('input.mode-suffix[value="left"]',p).checked?"left":b('input.mode-suffix[value="bottom"]',p).checked?"bottom":void 0)&&(o+=":"+s));var s=!!b('input.tabswrap[value="true"]',p).checked||void 0,d=b('input.theme[value="light"]',p).checked?"light":b('input.theme[value="dark"]',p).checked?"dark":void 0,c=b('input.scripts[value="named"]',p).checked?"named":b('input.scripts[value="edit"]',p).checked?void 0:"noedit",l=b('input.strict[value="always"]',p).checked?"always":b('input.strict[value="external"]',p).checked?"external":void 0;let u=[];m("input.editor",p).forEach(e=>{var t=e.checked,n=e.hasAttribute("checked");t!==n&&u.push((n?"no":"")+e.getAttribute("value"))}),u=0<u.length?u.join(","):void 0;n=JSON.parse(JSON.stringify({urls:n,mode:o,theme:d,fontsize:r,savestats:a,ffmpeg:i,strict:l,scripts:c,editor:u,tabslist:t,tabswrap:s}));dispatchEvent(Object.assign(new Event("settings"),{data:n})),x(s),A(t),E(c),O(u),C(r),setTimeout(()=>{k(p,!1)})},b('div.tab[tab="help"]'));b("button.help",s).onclick=e=>{if("undefined"!=typeof chrome&&chrome.runtime&&chrome.runtime.getManifest){var t=chrome.runtime.getManifest().homepage_url;window.open(t,"_blank")}else{const n=window.open("about:blank","_blank");fetch("../manifest.json?r="+(""+Math.random()).substring(2,10)).then(e=>e.text()).then(e=>{e=e.replace(/\\"|"(?:\\"|[^"])*"|(\/\/.*|\/\*[\s\S]*?\*\/)/g,(e,t)=>t?"":e);try{var t=JSON.parse(e);n.location.href=t.homepage_url}catch(e){console.error("failed to parse manifest.json",e)}}).catch(e=>{console.error("failed to fetch manifest.json",e)})}},b("button.print",s).onclick=e=>{const r=e.metaKey?"meta":null,o=window.open("about:blank","_blank");b("h2",s);const t=chrome.runtime&&chrome.runtime.id?[`<link rel="stylesheet" href="chrome-extension://${chrome.runtime.id}/options/ext/prism.min.css" />`,`<script src="chrome-extension://${chrome.runtime.id}/options/ext/prism.min.js"></script>`]:['<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerpolicy="no-referrer" />','<script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.28.0/prism.min.js" integrity="sha512-RDQSW3KoqJMiX0L/UBgwBmH1EmRYp8LBOiLaA8rBHIy+7OGP/7Gxg8vbt8wG4ZYd29P0Fnoq6+LOytCqx3cyoQ==" crossorigin="anonymous" referrerpolicy="no-referrer"><\/script>'];e=(new Date).toISOString().split("T")[0].replace(/-/g,"");o.document.write(`<!doctype html>
<html><head><title>rtchelper-${e}</title>
${t.join("\n")}
<style type="text/css">
body {
    margin: 8px;
    font-family: sans-serif;
}
@media print {
    body {
        counter-reset: page;
        counter-reset: section;
        font-family: serif;
        margin: 0;
    }
    body, div.desc, div.desc > *, label, p, a, li {
        font-size: 12pt;
        line-height: 16pt;
    }
    h1, h2, h3 {
        page-break-after: avoid;
    }
    h1 {
        font-size: 20pt;
    }
    h2 {
        font-size: 16pt;
        counter-reset: subsection;
        margin-top: 20pt;
    }
    div.cover {
        margin-top: 50%; margin-left: 25%;
    }
    div.cover > * {
        position: relative;
    }
    body > h1, h2:not([print]) {
        page-break-before: always;
    }
    h2 { page-break-before: always; }
    h2:before {
        counter-increment: section 1;
        content: counter(section) ".\\a0\\a0";
    }
    h3 {
        font-size: 14pt;
        margin-top: 20pt;
    }
    h3:before {
        counter-increment: subsection 1;
        content: counter(section) "." counter(subsection) "\\a0\\a0";
    }
    pre[class*="language-"]{
        /* border: solid 1px grey; */
        background-color: transparent !important;
        font-size: 9pt;
        /* page-break-inside: avoid; */
    }
    pre[class*="language-"], pre > code[class*="language-"]{
        white-space: pre-wrap;
        overflow-wrap: anywhere;
    }
    @page {
        counter-increment: page;
        size: 8.5in 11in;
        margin: 0.3in 0.5in;
        /*size: auto; margin: 5mm;*/
        @bottom-left {
            content: counter(page);
            font-size: 11pt;
        }
    }
    footer {
        display: block; position: fixed; bottom: 0px; right: 0px;
        margin-top: none; width: auto;
        font-size: 0.7em; font-style: normal !important;
    }
    thead { display: table-header-group; }
    tfoot { display: table-footer-group; }
    div.cover { page-break-after: always; }

    div.page-footer {
        height: 50px;
    }
    a {
        color: black;
    }

    img {
        zoom: 0.75; display: block;
    }
}
footer {
    margin-top: 16px;
    color: gray; font-style: italic;
    text-align: right;  width: 100%;
}
@media screen {
    .footnote {
        visibility: hidden;
    }
}
a {
    text-decoration: none;
}
dl {
    display: grid;
    grid-template-columns: 100px 1fr;
}
dl > dt {
    text-align: right; font-family: monospace; color: #07a;
}
dl > dd {
    margin-inline-start: 2ch;
}
table.topicdesc td {
    vertical-align: top;
}
pre[class*="language-"] {
    max-width: 8.5in;
}
</style></head><body>`);const n=m("h2[print],h3[print],label[print],img[print]",s);e=n.findIndex(e=>e.hasAttribute("later"));o.document.write(`<div class="cover">
                    <h1>RTC Helper</h1>
                    <p>By Kundan Singh, http://kundansingh.com</p>
                    <p>&copy; 2025-2026, All Rights Reserved.</p>
                </div>`),o.document.write('<table><thead><tr><td><div class="page-header"></div></td></tr></thead><tbody><tr><td>'),n.slice(0,e<0?void 0:e).forEach((e,t)=>{e=e.outerHTML;o.document.write(e)}),o.document.write('<h2 print>Customization Categories</h2><p>These high level topics are included:</p><ol class="toc">'),m("div.tab:not(.static)").forEach(e=>{var t=b("div.help div.title",e),e=e.getAttribute("tab");o.document.write(`<li><a href="#${e}">${t.innerText}</a></li>`)}),o.document.write("</ol>");const a=m("span[print],table.topicdesc[print]",s);a.forEach(e=>{o.document.write(e.outerHTML)}),m("div.tab:not(.static)").forEach(e=>{var t=b("div.help div.title",e),n=b("div.help div.desc",e),a=e.getAttribute("tab");o.document.write(`<h2 id="${a}">${t.innerText}</h2>
`+n.outerHTML),o.document.write("<p>Some builtin and preloaded examples are described next.</p>");const i=m("select option:not(:first-child)",e);i.forEach(e=>{let t=(e.data||"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");o.document.write(`<h3>${e.innerText}</h3>`);const n=t.match(/^((async\s+)?function\s*(\w+\s*)?\(([^\)]*)\)\s*\{)(\s*\/\*([\s\S]*?)\*\/)?(([\s\S]*)\}\s*)$/);n&&n[6]&&(e=n[6].replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\n(\s*\n)+/g,"<br/><br/>"),t=n[1]+n[7],o.document.write(`<span>${e}</span>`)),"meta"!==r&&(t=t.replace(/    /g,"  "),o.document.write(`<pre><code class="language-js">${t}</code></pre>`))})}),0<=e&&n.slice(e).forEach((e,t)=>{o.document.write(e.outerHTML)}),o.document.write('</td></tr></tbody><tfoot><tr><td><div class="page-footer"></div></td></tr></tfoot></table>'),o.document.write("<footer>RTC Helper &copy; 2025-2026, Kundan Singh</footer>"),o.document.write("</body></html>"),o.document.close(),setTimeout(()=>{o.print()},100)}}f(functions);{var n=functions;const d=b('div.tab[tab="help"] ol.features');c.filter(e=>!e.static).forEach(e=>{const i=e.tab;if(document.body.hasAttribute("extension")||"pagesecurity"!=i&&"cpuperformance"!=i){const t=document.createElement("span");t.setAttribute("tab",i),t.data={type:i},t.innerText=e.title,d.appendChild(t),n[e.tab]&&Object.keys(n[e.tab]).forEach(e=>{const t=document.createElement("li");t.setAttribute("tab",i),t.data={type:i,question:e};let n=e;var a=e.indexOf(" - ");n=(n=0<=a?e.substring(a+3):n).substring(0,1).toUpperCase()+n.substring(1),t.innerText=n,d.appendChild(t),t.onclick=e=>{const n=e.currentTarget,t=b(`div.nav > div[tab="${n.data.type}"]:not([hidden])`);if(t){t.click();const i=b(`div.content > div.tab[tab="${n.data.type}"]`);if(i){i.click();e=b("select",i);if(e){let t=null;var a=[].slice.call(e.children).findIndex(e=>(t=e.data,e.innerText==n.data.question));i.editor&&(w(i.editor,t,e),k(i,!0)),0<=a&&y(e,a)}}}}})}})}m("div.content > div.tab").forEach((n,e)=>{b("div.editor",n)&&(b("select",n).onchange=e=>{var t;e.currentTarget.selectedOptions&&(k(n,!0),t=e.currentTarget.selectedOptions[0].data,w(n.editor,t,e.currentTarget))})});const i=b('div.tab[tab="mediarecord"]'),r=(b("button.start",i).onclick=e=>{j("requesting record start..."),dispatchEvent(Object.assign(new Event("request"),{data:{name:"start_mediarecord",args:["chrome-extension:"===location.protocol]}}))},b("button.stop",i).onclick=e=>{j("requesting record stop..."),dispatchEvent(Object.assign(new Event("request"),{data:{name:"stop_mediarecord",args:[]}}))},b("button.playback",i).onclick=b("button.download",i).onclick=b("button.download-mp4",i).onclick=e=>{j("requesting recorded data..."),i._onresponse=e.currentTarget.className,dispatchEvent(Object.assign(new Event("request"),{data:{name:"get_mediarecord",args:[]}}))},b('div.tab[tab="mediastats"]')),o=(b("div.open",r).onclick=e=>{dispatchEvent(new Event("statsopen"))},b("div.graphs",r).onclick=e=>{var t=e.currentTarget.lastElementChild?.getBoundingClientRect(),n=e.currentTarget.getBoundingClientRect(),a=e.clientX,i=e.clientY;if(i>=n.top&&i<n.top+16){i=t.left/2+t.width/2<n.left+n.width;if(i&&a>=t.left/2+t.width/2&&a<t.left/2+t.width/2+16||!i&&a>=n.left+n.width-16&&a<n.left+n.width){const r=[...e.currentTarget.children];r.forEach(e=>{R(e.getAttribute("name"),e)})}}},b('div.tab[tab="cpuperformance"]'));return b("button.show",o).onclick=e=>{dispatchEvent(new Event("show_cpuperformance"))},b("button.hide",o).onclick=e=>{dispatchEvent(new Event("hide_cpuperformance"))},void document.addEventListener("keydown",function(e){const t=window.navigator?.userAgentData?.platform||window.navigator?.platform||"";if((t.match(/mac/i)?e.metaKey:e.ctrlKey)&&(e.key&&"s"===e.key||e.keyCode&&83===e.keyCode)){e.preventDefault();e=b(`div.tab[tab="${document.body.getAttribute("selected")}"]`);const n=e&&b("button.save",e);n&&n.click()}},!1)}});const c=[];function b(e,t){return(t||document).querySelector(e)}function m(e,t){return[].slice.call((t||document).querySelectorAll(e))}function f(s,d){m("div.content > div.tab").forEach((e,t)=>{const a=e.getAttribute("tab");if(b("div.editor",e)){const i=b("select",e),n=Object.keys(s[a]||[]);if(d&&0<n.length){const r=document.createElement("option");r.setAttribute("source",d),r.setAttribute("role","separator"),r.innerHTML="&#x2500;".repeat(4)+" "+d+" "+"&#x2500;".repeat(4),r.setAttribute("disabled",""),i.appendChild(r)}if(n.sort().forEach(e=>{var t=s[a][e].toString();const n=document.createElement("option");n.innerText=e,n.data=t,d&&n.setAttribute("source",d),i.appendChild(n)}),0==i.selectedIndex&&e.editor){const o=e.editor.getValue()||"",t=[].slice.call(i.children).findIndex(e=>e.data==o);0<=t&&y(i,t)}}})}let i=void 0;function g(e,t){if(void 0!==t){const n=(i=t)?Object.keys(t):[];m('div.tab[tab="settings"] > div[name]').forEach(e=>{var t=e.getAttribute("name");0<=n.indexOf(t)?e.setAttribute("disabled",""):e.removeAttribute("disabled")})}if(i&&(e=e||{},Object.assign(e,i)),void 0!==e){t=b('div.tab[tab="settings"]');b("textarea.tabslist",t).value=e.tabslist||"",b("textarea.urls",t).value=e.urls||"",b("textarea.savestats",t).value=e.savestats||"",b("textarea.ffmpeg",t).value=e.ffmpeg||"",b("select.fontsize",t).value=e.fontsize||"small",b('input.mode[value="open"]',t).checked=e.mode&&e.mode.startsWith("open"),b('input.mode[value="open-pinned"]',t).checked="open-pinned"==e.mode,b('input.mode[value="open-popup"]',t).checked="open-popup"==e.mode,b('input.mode[value="inline"]',t).checked=e.mode&&e.mode.startsWith("inline"),b('input.mode[value="inline-float"]',t).checked=e.mode&&e.mode.startsWith("inline-float"),b('input.mode-suffix[value="left"]',t).checked=e.mode&&e.mode.startsWith("inline")&&e.mode.endsWith(":left"),b('input.mode-suffix[value="bottom"]',t).checked=e.mode&&e.mode.startsWith("inline")&&e.mode.endsWith(":bottom"),b('input.tabswrap[value="true"]',t).checked=!!e.tabswrap,b('input.theme[value="light"]',t).checked="light"==e.theme,b('input.theme[value="dark"]',t).checked="dark"==e.theme,b('input.scripts[value="edit"]',t).checked=!e.scripts||"noedit"!=e.scripts,b('input.scripts[value="named"]',t).checked="named"==e.scripts,b('input.strict[value="always"]',t).checked="always"==e.strict,b('input.strict[value="external"]',t).checked="external"==e.strict;const a=e.editor?e.editor.split(","):[];m("input.editor",t).forEach(e=>{e.hasAttribute("checked")?e.checked=a.indexOf("no"+e.getAttribute("value"))<0:e.checked=!(a.indexOf(e.getAttribute("value"))<0)}),x(e.tabswrap),A(e.tabslist),E(e.scripts),O(e.editor),C(e.fontsize)}}function y(e,t){e.selectedIndex=t}function k(e,t,n){t?e.hasAttribute("dirty")||e.setAttribute("dirty",""):e.hasAttribute("dirty")&&e.removeAttribute("dirty",""),n||e.hasAttribute("editing")&&(e.removeAttribute("editing"),b("input.caption",e).value="")}let o=!0;function w(e,t,n){e&&(n.changing=!0,e.setValue(t||"",-1),o&&setTimeout(()=>{e.session.foldAllComments()}),delete n.changing)}function x(e){e?(b("div.nav").style.setProperty("flex-wrap","wrap"),b("div.nav > div.after").style.setProperty("display","none"),b("div.nav > div.before").style.setProperty("display","none"),m("div.nav > div").forEach(e=>e.style.setProperty("border-bottom-width","2px"))):(b("div.nav").style.removeProperty("flex-wrap"),b("div.nav > div.after").style.removeProperty("display"),b("div.nav > div.before").style.removeProperty("display"),m("div.nav > div").forEach(e=>e.style.removeProperty("border-bottom-width")))}let r=void 0;function A(e){let n=e?e.split(",").map(e=>e.trim()).filter(e=>!!e):null;n&&!n.length&&(n=void 0);var e=(r||[]).join(","),t=(n||[]).join(",");r=n;const a=[];m("div.nav > div[tab]").forEach(e=>{var t=e.innerText;n&&n.indexOf(t)<0?"Settings"!=t?e.hasAttribute("hidden")||e.setAttribute("hidden",""):e.hasAttribute("hidden")&&e.removeAttribute("hidden"):(n&&a.push(e.getAttribute("tab")),e.hasAttribute("hidden")&&e.removeAttribute("hidden"))}),e!=t&&(n?(m("div.nav > div[tab]").forEach(e=>{e.innerText;var t=n.indexOf(e.innerText);e.style.setProperty("order",""+(t<0?98:t))}),b("div.nav > div.before").style.setProperty("order","-1"),b("div.nav > div.after").style.setProperty("order","99")):m("div.nav > div[tab], div.nav > div.before, div.nav > div.after").forEach(e=>{e.style.removeProperty("order")}),n?m('div.tab[tab="help"] ol.topics > li[tab], div.tab[tab="help"] ol.features > li[tab], div.tab[tab="help"] ol.features > span[tab]').forEach(e=>{var t=e.getAttribute("tab");a.indexOf(t)<0?e.setAttribute("hidden",""):e.removeAttribute("hidden")}):m('div.tab[tab="help"] ol.topics > li[tab], div.tab[tab="help"] ol.features > li[tab], div.tab[tab="help"] ol.features > span[tab]').forEach(e=>{e.removeAttribute("hidden")}))}let T=void 0;function E(t){const n=T;n!==t&&(T=t,m("div.content > div.tab[tab]:not(.static)").forEach(e=>{e.editor&&e.editor.setReadOnly("noedit"==t)}),"named"!=n&&"named"!=t||m("div.content > div.tab[tab]:not(.static)").forEach(e=>{e.editor&&("named"==n?e.removeAttribute("editing"):e.hasAttribute("dirty")&&0==e.querySelector("select").selectedIndex&&e.setAttribute("editing",""))}))}function O(e){const a=[],i=[],t=(m("div.content > div.tab[tab]:not(.static)").forEach(e=>{e.editor&&(a.push(e.editor),i.push(e))}),m('div.tab[tab="settings"] input.editor').map(e=>{return{value:e.getAttribute("value"),def:e.hasAttribute("checked")}})),r=e?e.split(","):[];t.forEach(({value:e,def:t})=>{const n=t?r.indexOf("no"+e)<0:!(r.indexOf(e)<0);switch(e){case"wrap":a.forEach(e=>e.session.setUseWrapMode(n));break;case"highlightline":a.forEach(e=>e.setHighlightActiveLine(n));break;case"highlightword":a.forEach(e=>e.setHighlightSelectedWord(n));break;case"invisibles":a.forEach(e=>e.setShowInvisibles(n));break;case"indentguide":a.forEach(e=>e.setDisplayIndentGuides(n));break;case"foldcomment":o=n,i.forEach(e=>{const t=e.editor;var n=b("select",e),a=e.hasAttribute("dirty");w(t,t.getValue()||"",n),k(e,a,!0)});break;default:console.warn("unsupported attribute",e)}})}let n=null;function j(e){const t=b('div.tab[tab="mediarecord"]');b("span.status",t).innerText=e,n&&clearTimeout(n),n=setTimeout(()=>{n=null,b("span.status",t).innerText===e&&(b("span.status",t).innerText="")},5e3)}function u(e){const t=b('div.tab[tab="mediarecord"]');var n,r,o,a=t._onresponse;function i(e,n){var t,a=new FileReader,i=(a.onload=function(){t=this.result,i()},a.readAsArrayBuffer(e),(r=r||(chrome.runtime&&chrome.runtime.id?new Worker("../../ffmpeg_asm/worker.js"):(a=URL.createObjectURL(new Blob(['importScripts("'+o+'");var now = Date.now;function print(text) {postMessage({"type" : "stdout","data" : text});};onmessage = function(event) {var message = event.data;if (message.type === "command") {var Module = {print: print,printErr: print,files: message.files || [],arguments: message.arguments || [],TOTAL_MEMORY: message.TOTAL_MEMORY || false};postMessage({"type" : "start","data" : Module.arguments.join(" ")});postMessage({"type" : "stdout","data" : "Received command: " +Module.arguments.join(" ") +((Module.TOTAL_MEMORY) ? ".  Processing with " + Module.TOTAL_MEMORY + " bits." : "")});var time = now();var result = ffmpeg_run(Module);var totalTime = now() - time;postMessage({"type" : "stdout","data" : "Finished processing (took " + totalTime + "ms)"});postMessage({"type" : "done","data" : result,"time" : totalTime});}};postMessage({"type" : "ready"});'],{type:"application/javascript"})),e=new Worker(a),URL.revokeObjectURL(a),e))).onmessage=function(e){var t,e=e.data;"ready"==e.type?(j("ffmpeg-asm.js is loaded"),console.log("ffmpeg-asm.js file has been loaded")):"stdout"==e.type?(j("ffmpeg-asm.js: "+e.data),console.log(e.data)):"start"==e.type?(j("ffmpeg-asm.js is initiated"),console.log("ffmpeg-asm.js file received ffmpeg command.")):"done"==e.type&&(j("ffmpeg-asm.js is done conversion"),console.log(JSON.stringify(e)),(e=e.data[0])?(t=e.data.length||e.data.size||e.data.byteLength,console.log("length",t),e=0<t?new File([e.data],"test.mp4",{type:'video/mp4"'}):null,t||j("failed to convert to mp4"),n&&n(e)):console.warn("ffmpeg-asm.js invalid data on done"))},function(){var e=b('div.content > div.tab[tab="settings"] textarea.ffmpeg').value||"-c:v mpeg4 -b:v 6400k -strict experimental";r.postMessage({type:"command",arguments:`-i video.webm ${e} output.mp4`.split(" "),files:[{data:new Uint8Array(t),name:"video.webm"}]})})}a&&(delete t._onresponse,e?"download"==a?(j("downloading recorded data"),d(e,".webm"),URL.revokeObjectURL(e)):"download-mp4"==a?(j("converting recording to mp4"),a=e,n=e=>{s(e,()=>{URL.revokeObjectURL(e)})},o="https://archive.org/download/ffmpeg_asm/ffmpeg_asm.js","localhost"==document.domain&&(o=location.href.replace(location.href.split("/").pop(),"")+"../ffmpeg_asm/ffmpeg_asm.js"),p(a,e=>{i(e,e=>{e&&(d(e=URL.createObjectURL(e),".mp4"),n?n(e):URL.revokeObjectURL(e))})})):(j("playing recorded data"),s(e,()=>{URL.revokeObjectURL(e)})):(j("invalid recorded data"),console.warn("invalid recording URL",e)))}function s(e,t){const n=b('div.tab[tab="mediarecord"]'),a=(n.setAttribute("showvideo",""),setTimeout(()=>{n.editor.resize()},200),b("video",n));a.autoplay=a.controls=!0,a.muted=!1,a.srcObject=null,a.src=e,a.onended=()=>{n.removeAttribute("showvideo"),t?t():URL.revokeObjectURL(e),a.src="",setTimeout(()=>{n.editor.resize()})}}function p(e,t){var n=new XMLHttpRequest;n.responseType="blob",n.onload=function(){var e=n.response;t&&t(e)},n.open("GET",e),n.send()}function d(e,t){const n=document.createElement("a");document.body.appendChild(n),n.style="display: none",n.href=e;e=(new Date).toISOString().replace(/[\-:\.ZT]/g,"");n.download="mediarecord-"+e+t,n.click()}let M=void 0;function L(a,e){const t=b("template#control-item"),n=t.content.cloneNode(!0),i=n.querySelector("div.item"),r=a.type,o=a.varname||a.name;i.data=a,i.setAttribute("varname",o),i.setAttribute("type",r),b('input[name="varname"]',i).value=o;var s,d=void 0!==a.value?a.value:"";b('input[name="value"]',i).value=d,b('input[name="value"]',i).oldvalue="";const c=e=>{var t=b('input[name="value"]',i).oldvalue,n=b('input[name="value"]',i).value;t!==n&&(b('input[name="value"]',i).oldvalue=n,{value:t,error:n}=function(e,t){let n,a=t;var i;if("boolean"==e.type?t.match(/^true|false$/)?t="true"===t:n="invalid boolean":"selection"==e.type?e.pattern.split("|").indexOf(t)<0&&(n="invalid selection"):"number"==e.type?t.match(/^\-?\d+(\.\d+)?$/)?t=parseFloat(t):n="invalid number":"range"==e.type&&(t.match(/^\-?\d+(\.\d+)?$/)?(t=parseFloat(t),(i=e.pattern.match(/^(\-?\d+)\-(\-?\d+)/))&&t>=parseFloat(i[1])&&t<=parseFloat(i[2])||(n="not in range")):n="invalid number"),!n&&e.pattern&&("number"==e.type||"string"==e.type))try{var r=e.pattern.replace(/^\^/,"").replace(/\$/,""),o=new RegExp(`^${r}$`);a.match(o)||(n="incorrect "+e.type+" pattern")}catch(e){n="incorrect pattern"}return{value:t,error:n}}(a,n),n?(i.setAttribute("error","value"),delete a.value):(i.removeAttribute("error"),a.value=t),e||u.setAttribute("dirty",""))};c(!0),b('input[name="value"]',i).onkeyup=e=>{a.readonly||"string"!=r&&"number"!=r||setTimeout(()=>{c()})},a.label?b('input[name="value"]',i).setAttribute("title",a.label):b('input[name="value"]',i).removeAttribute("title");let l=a.readonly;"boolean"==r?(b('input[name="boolean"]',i).checked=d,l=!0,b('input[name="boolean"]',i).onclick=e=>{b('input[name="value"]',i).value!==""+e.currentTarget.checked&&(b('input[name="value"]',i).value=e.currentTarget.checked,c())}):"selection"==r?(a.pattern.split("|").filter(e=>!!e).forEach(e=>{const t=document.createElement("option");t.innerText=e,b('select[name="selection"]',i).appendChild(t)}),b('select[name="selection"]',i).value=d,l=!0,b('select[name="selection"]',i).onchange=e=>{b('input[name="value"]',i).value!==e.currentTarget.value&&(b('input[name="value"]',i).value=e.currentTarget.value,c())}):"range"==r?((s=a.pattern.match(/^(\-?\d+)\-(\-?\d+)(\/(\d+))?$/))&&(b('input[name="range"]',i).setAttribute("min",s[1]),b('input[name="range"]',i).setAttribute("max",s[2]),s[3]&&b('input[name="range"]',i).setAttribute("step",s[4])),b('input[name="range"]',i).value=d,l=!0,b('input[name="range"]',i).oninput=e=>{b('input[name="value"]',i).value!==e.currentTarget.value&&(b('input[name="value"]',i).value=e.currentTarget.value,c())}):"event"==r&&(b('button[name="event"]',i).onclick=e=>{var t=b('input[name="value"]',i).value,t={varname:o,value:t};dispatchEvent(Object.assign(new Event("trigger"),{data:t}))}),l&&b('input[name="value"]',i).setAttribute("readonly","");const u=b('div.tab[tab="usercontrols"]');b("button.delete",i).onclick=e=>{u.setAttribute("dirty",""),b("div.variables",u).removeChild(i)},e?b("div.variables",u).insertBefore(i,b("div.variables div.item.add").nextElementSibling):b("div.variables",u).appendChild(i)}const S={};function R(e,t){b("div.tab[tab='mediastats'] div.graphs").removeChild(t),t.onmouseover=t.onmouseout=t.onclick=null,clearInterval(S[e].interval),delete S[e],console.log("delete graph "+e),l()}function l(){Object.keys(S).length||setTimeout(()=>{const e=b('div.content > div.tab[tab="mediastats"]');e&&e.editor&&e.editor.resize()},500)}function $(n){var a=S[n];if(a){const l=200;let e=b(`div.tab[tab="mediastats"] div.graphs > canvas[name="${n}"]`);e=e||function(t,e,n){console.log("create graph "+t);const a=document.createElement("canvas");return a.setAttribute("name",t),a.width=e,a.height=n,b("div.tab[tab='mediastats'] div.graphs").appendChild(a),a.onmouseover=e=>{e.currentTarget.setAttribute("hover",""),$(t)},a.onmouseout=e=>{e.currentTarget.removeAttribute("hover"),$(t)},a.ondblclick=e=>{R(t,e.currentTarget)},a}(n,400,l);var o=Object.values(a.data).filter(e=>0<e.length).map(e=>e[e.length-1].x).filter(e=>void 0!==e),s=Object.values(a.data).map(e=>e.map(e=>e.y)).flat();if(0<o.length&&0<s.length){const u=Math.round(Date.now()/1e3),t=u-400;let i=Math.max(...s),r=Math.min(0,Math.min(...s));if((i=i<10?10:i)===r&&(i=r+1),Object.entries(a.data).forEach(([,e])=>{for(;0<e.length&&e[0].x<t;)e.shift()}),Object.values(a.data).filter(e=>e.length).length){o=i-r+"",s=o.length,o=parseInt(o[0]);let t=parseInt((5<=o?"5":"1").padEnd(s,"0"));i/t<2&&(t=Math.round(t/2)),100===i&&(t=25),a.options&&(void 0!==a.options.ymax&&(i=a.options.ymax),void 0!==a.options.ymin&&(r=a.options.ymin),void 0!==a.options.ystep&&(t=a.options.ystep));const p=e.getContext("2d");p.clearRect(0,0,400,l),p.beginPath(),p.lineWidth="1",p.strokeStyle="grey",p.font="20px sans-serif";for(let e=r+t;e<=i;e+=t){var d=(i-e)*l/(i-r),c=(p.moveTo(0,d),p.lineTo(400,d),isNaN(e)?"???":e<1e3?e:e<1e6?Math.round(e/1e3)+"K":Math.round(e/1e6)+"M");p.fillStyle="rgba(255,255,255,0.8)",p.fillRect(4,d,p.measureText(""+c).width,20),p.fillStyle="grey",p.fillText(""+c,4,20+d)}p.stroke();const v=["red","green","blue","orange","black"],m=[];if(Object.entries(a.data).forEach(([e,t],n)=>{var a;t.length&&(a=t[t.length-1].y,m.push({name:e,value:a}),p.beginPath(),p.lineWidth="1",p.strokeStyle=v[n%v.length],t.forEach(({x:e,y:t},n)=>{e=400-u+e,t=(i-t)*l/(i-r);0===n?p.moveTo(e,t):p.lineTo(e,t)}),p.stroke())}),e.hasAttribute("hover")){const h=m.map((e,t)=>{var n=e.value,n=isNaN(n)?"???":n<1e3?n:n<1e6?Math.round(n/1e3)+"K":Math.round(n/1e6)+"M",a=v[t%v.length],n=n+" "+e.name,e=l-20*(t+1)-4;return{color:a,width:p.measureText(n).width,top:e,text:n}});o=[p.measureText(""+n).width].concat(h.map(e=>e.width)).reduce((e,t)=>Math.max(e,t),0);p.fillStyle="rgba(255,255,255,0.8)",p.fillRect(70,l-20*(m.length+1)-4,o,196),h.forEach(({color:e,top:t,text:n})=>{p.fillStyle=e,p.fillText(n,70,t)}),p.fillStyle="black",p.fillText(""+n,70,196)}}else R(n,e)}}}function C(e){e&&"small"!=e?document.body.setAttribute("fontsize",e):document.body.hasAttribute("fontsize")&&document.body.removeAttribute("fontsize")}window.setData=function(a){m("div.content > div.tab:not(.static)").forEach(e=>{const t=e.getAttribute("tab");var n=b("select",e);n&&(y(n,0),w(e.editor,a[t],n),k(e,!1),0<=(e=[].slice.call(n.children).findIndex(e=>e.data==a[t]))&&y(n,e))});{var e=a.usercontrols;const t=b('div.tab[tab="usercontrols"]'),n=(k(t,!1),(M=e)&&e.variables||[]);return void n.forEach(e=>{L(e)})}},window.clearData=function(){m("div.content > div.tab").forEach(e=>{e.getAttribute("tab");var t=b("select",e);t&&(k(e,!1),y(t,0),w(e.editor,"",t))})},window.onResponse=function(e,t){if("get_mediarecord"==e){var{bloburl:t,duration:n}=t||{};{var a=t;var i=n;var r=e=>{u(e)};const o=()=>{p(a,e=>{URL.revokeObjectURL(a),window.ysFixWebmDuration(e,i,function(e){r&&r(URL.createObjectURL(e))},{logger:!1})})};if(document.head.querySelector("script#fix-webm-duration"))o();else{const s=document.createElement("script");s.id="fix-webm-duration",s.src="../fix-webm-duration/fix-webm-duration.js",s.onload=()=>{o()},document.head.appendChild(s)}}}else if("start_mediarecord"==e){if(j("started recording, click stop when done"),"chrome-extension:"!==location.protocol&&window!==window.parent){const d=b('div.tab[tab="mediarecord"]'),c=(d.setAttribute("showvideo",""),setTimeout(()=>{d.editor.resize()},500),b("video",d));if(window.parent._rtchelper_stream)c.srcObject=window.parent._rtchelper_stream;else{let e=10,t=setInterval(()=>{if(--e,window.parent._rtchelper_stream)c.srcObject=window.parent._rtchelper_stream;else{if(0<e)return;console.error("failed to capture stream after 2s")}clearInterval(t),t=0},200)}c.autoplay=c.muted=!0,c.controls=!1}}else if("stop_mediarecord"==e){j("stopped recording");const l=b('div.tab[tab="mediarecord"]');l.hasAttribute("showvideo")&&(l.removeAttribute("showvideo"),setTimeout(()=>{l.editor.resize()})),b("video",l).srcObject=null}},window.addFunctions=f,window.setFunction=function(n,a){const{type:e,text:i,caption:r}=n,o=b(`div.tab[tab="${e}"]`),s=b("select",o);if(b("div.editor",o)&&s){const d=m(`option[source="${a}"]:not([role])`,s);var n=d.findIndex(e=>e.innerText==r);let t=0<=n?d[n]:null;if(i){let e=b(`option[role="separator"][source="${a}"]`,s);if(e||((e=document.createElement("option")).setAttribute("source",a),e.setAttribute("role","separator"),e.innerHTML="&#x2500;".repeat(4)+" "+a+" "+"&#x2500;".repeat(4),e.setAttribute("disabled",""),s.appendChild(e)),t?t.data!==i&&(t.data=i):((t=document.createElement("option")).innerText=r,t.data=i,t.setAttribute("source",a),s.insertBefore(t,e.nextElementSibling)),0==s.selectedIndex&&o.editor){const i=o.editor.getValue()||"";var n=[].slice.call(s.children).findIndex(e=>e.data==i);0<=n&&y(s,n)}}else t&&(n=s.selectedOptions[0]===t,s.removeChild(t),n&&(s.selectedIndex=0),m(`option[source="${a}"]:not([role])`,s).length||(n=b(`option[role="separator"][source="${a}"]`,s))&&s.removeChild(n))}},window.setSettings=g,window.setUserControls=function(t){if(M&&M.variables){const n=M.variables.find(e=>e.varname==t.varname);if(n){n.value=t.value;var e=b('div.tab[tab="usercontrols"]');const a=b(`div[varname="${t.varname}"]`,e);b('input[name="value"]',a).value=t.value,a?(a.value=t.value,"boolean"==n.type?b('input[name="boolean"]',a).checked=t.value:"selection"==n.type?b('select[name="selection"]',a).value=t.value:"range"==n.type&&(b('input[name="range"]',a).value=t.value)):console.warn("not found div",t.varname)}}},window.setMediastats=function(e,t,n,a,i){let r=S[e];r||(l(),(r=S[e]={dirty:!1,data:{},options:i}).interval=setInterval(()=>{$(e)},1e3),setTimeout(()=>{$(e)},0)),r.data[t]||(r.data[t]=[]),r.data[t].push({x:n,y:a}),r.dirty=!0},window.setTab=function(e){const t=b("default"==e?"div.nav > div[tab]":`div.nav > div[tab="${e}"]`);t&&t.click()}}();
