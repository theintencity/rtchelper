<!doctype html><html><head><title>RTC Helper Options</title><meta content="text/html; charset=utf-8"http-equiv="Content-Type"><meta http-equiv="X-UA-Compatible"content="chrome=1"><meta name="author"content="Kundan Singh"><meta name="keywords"content="WebRTC,Helper"><meta name="description"content="Analyze, customize and improve audio/video communication on any website"><link rel="stylesheet"type="text/css"href="options.css"><script type="text/javascript"src="ext/ace.js"></script><script type="text/javascript"src="functions.js"integrity="sha384-Jg8jJzW6ZUUxdEhQevqeT8xXO62bOmcpBdANg1t2/BIIASR1PylXrBY6+CA47BF2"crossorigin="anonymous"></script><script type="text/javascript"src="options.js"integrity="sha384-dy3FhpTPyRC5kJmj762YWh9HssNV7zfjfoFjxjHb55OUuqU0c7wF1HvLli8hiM8W"></script></head><body selected="videocapture"><template id="tab-item"><div tab="{{tab}}"title="{{title}}">{{name}}</div><div class="tab"tab="{{tab}}"><div class="help"><div class="title"></div><div class="desc"></div></div><div class="toolbar"><select title="Select built-in customization, and/or edit below."><option>Select...</option></select> <input class="caption"type="text"placeholder="Type description here..."> <button class="save"title="Save and apply the changes. Press ctrl+S or cmd+S"></button></div><div class="editor"></div></div><div tab="mediarecord"><div class="playback"><video autoplay muted></video></div><div class="toolbar"><button class="start"title="Start recording">Start</button> <button class="stop"title="Stop or pause recording">Stop</button> <button class="playback"title="Play recorded file">Play</button> <button class="download"title="Download recorded file">Save</button> <button class="download-mp4"title="Download recorded file as mp4">MP4</button> <span class="status"></span></div></div><div tab="mediastats"><div class="open"title="display stored statistics if any">open</div><div class="graphs"></div></div><div tab="cpuperformance"><div class="graphs"></div><div class="toolbar"><button class="show"title="Show CPU performance monitor">Show</button> <button class="hide"title="Hide CPU performance monitor">Hide</button></div></div></template><template id="control-item"><div class="item"type="{{type}}"><button class="delete"title="delete this variable">&times;</button> <input name="varname"type="text"disabled="disabled"readonly="readonly"autocomplete="off"> <input name="value"type="text"placeholder="value"pattern="^\d+$"title="{{label}}"autocomplete="off"> <input name="boolean"type="checkbox"title="This boolean variable is true if checked, or false otherwise."> <input name="range"type="range"> <select name="selection"></select> <button name="event"title="click to trigger the event">Trigger</button><div class="flex"></div></div></template><div class="nav"><div class="before">&#xab;</div><div class="last"tab="usercontrols"title="Define user controllable variables">Control</div><div tab="settings"title="Configure the helper tool">Settings</div><div tab="help"title="Get help or search documentation">Help</div><div class="after">&#xbb;</div></div><div class="content"><div class="tab"tab="videocapture"name="Capture"><div class="help"><div class="title">Customize the webcam capture feed</div><div class="desc"><span>It uses an internal canvas to generate the video returned by any getUserMedia stream, and allows drawing on the canvas for each frame. The function defined below is called periodically to draw the video image. The function can access one webcam video or multiple webcam videos. The function may be async, in which case the subsequent calls are not invoked until the previous one returns. These optional named parameters are allowed.</span><dl><dt>canvas</dt><dd>target &lt;canvas&gt; element to draw on to.</dd><dt>video</dt><dd>source &lt;video&gt; element from the default webcam.</dd><dt>videos</dt><dd>an array of source &lt;video&gt; elements from all the webcams.</dd><dt>screen</dt><dd>source &lt;video&gt; element of screen share.</dd><dt>data</dt><dd>the state object assigned to the canvas and includes the start time of the stream.</dd><dt>upload</dt><dd>asynchronous function for click to select one or more file.</dd><dt>segment</dt><dd>asynchronous function to use selfie segmentation using mediapipe on an image or video.</dd><dt>facedetect</dt><dd>asynchronous function to use face detection using mediapipe on an image or video.</dd><dt>respath</dt><dd>path string to access internal resources such as images.</dd><dt>cleanup</dt><dd>if present, then the function is additionally called on cleanup with parameter value of true.</dd></dl><span>Following optional parameters are common across most tabs.</span><dl><dt>global</dt><dd>an object representing global data useful in strict mode.</dd><dt>console</dt><dd>an object in lieu of window.console for logging in strict mode.</dd><dt>location</dt><dd>an object in lieu of window.location for accessing web page URL in strict mode.</dd><dt>controls</dt><dd>an object to access the shared variables with the controls tab.</dd></dl></div></div></div><div class="tab"tab="screencapture"name="Screen"><div class="help"><div class="title">Customize the screen capture feed</div><div class="desc"><span>It uses an internal canvas to generate the video images returned by any getDisplayMedia stream, and allows drawing on the canvas for each frame. This is similar to the webcam capture feature. The function defined below is called periodically to draw the video image. The function can access one screen or app video, one webcam video or multiple webcam videos, or multiple screen or app videos. For single screen or app video use the screen parameter described below. For multiple screen or app videos, use screen1, screen2, and similar parameters. The function may be async, in which case subsequent calls are not invoked until the previous one returns. These optional named parameters are allowed.</span><dl><dt>canvas</dt><dd>target &lt;canvas&gt; element to draw on to.</dd><dt>video</dt><dd>source &lt;video&gt; element from the default webcam.</dd><dt>videos</dt><dd>an array of source &lt;video&gt; elements from all the webcams.</dd><dt>screen</dt><dd>source &lt;video&gt; element of screen or app share, or use screen1, screen2, and so on for multiple sources.</dd><dt>respath</dt><dd>path string to access internal resources such as images.</dd><dt>data</dt><dd>the state object assigned to the canvas and includes the start time of the stream.</dd><dt>cleanup</dt><dd>if present, then the function is additionally called on cleanup with parameter value of true.</dd></dl><span>Following optional parameters are common across most tabs.</span><dl><dt>global</dt><dd>an object representing global data useful in strict mode.</dd><dt>console</dt><dd>an object in lieu of window.console for logging in strict mode.</dd><dt>location</dt><dd>an object in lieu of window.location for accessing web page URL in strict mode.</dd><dt>controls</dt><dd>an object to access shared variables with the controls tab.</dd></dl></div></div></div><div class="tab"tab="mediarecord"name="Record"><div class="help"><div class="title">Perform media recording with customized video layout and audio mixing</div><div class="desc"><span>It allows combining all the displayed video elements on the web page into a recorded video, and allows drawing on the internal canvas used for the recorded video stream. The function defined below is called periodically to draw the combined recorded video image. Audios from all the audio and video elements are implicitly combined in the recording for all audio sources of media streams. The function may be async, in which case the subsequent calls are not invoked until the previous one returns. These optional named parameters are allowed.</span><dl><dt>canvas</dt><dd>target &lt;canvas&gt; element to draw on to.</dd><dt>videos</dt><dd>an array of all the &lt;video&gt; elements on the page.</dd><dt>states</dt><dd>an array of strings representing video element state in the same order, e.g., one of playing, empied, suspend, ended, or error.</dd><dt>data</dt><dd>the configuration object used as follows. On first invocation, the frameRate and mimeType attributes of data may be set in the function. Defaults are 15 (fps) and 'video/webm; codecs="h264,opus"'. Use mimeType of 'video/webm; codecs="h264,pcm"' to enable download in MP4, which currently works only on Chrome.</dd><dt>usermedia</dt><dd>if present then includes audio from the user media calls, e.g., if microphone audio is not attached to any audio or video element.</dd><dt>mediaconnect</dt><dd>if present then intercepts audio from peer connections instead of audio and video elements.</dd><dt>noaudio</dt><dd>if present then disables audio recording.</dd><dt>getstyle</dt><dd>function to call in lieu of window.getComputedStyle on a video object in strict mode.</dd><dt>cleanup</dt><dd>if present, then the function is additionally called on cleanup with parameter value of true.</dd></dl><span>Following optional parameters are common across most tabs.</span><dl><dt>global</dt><dd>an object representing global data useful in strict mode.</dd><dt>console</dt><dd>an object in lieu of window.console for logging in strict mode.</dd><dt>location</dt><dd>an object in lieu of window.location for accessing web page URL in strict mode.</dd><dt>controls</dt><dd>an object to access shared variables with the controls tab.</dd></dl></div></div></div><div class="tab"tab="mediadisplay"name="Videos"><div class="help"><div class="title">Customize and interact with all the audio and video elements</div><div class="desc"><span>It allows intercepting and modifying every audio and video element on the webpage. The function defined below is called for every audio and video element on the web page, on creation, destroy, state change and click. It can intercept changes to the media elements. The function may be async. These optional named parameters are allowed.</span><dl><dt>video</dt><dd>the source &lt;audio&gt; or &lt;video&gt; element.</dd><dt>open</dt><dd>function to call in lieu of window.open with blob URL in a blank tab in strict mode.</dd><dt>data</dt><dd>the state object assigned to the element and includes an state attribute with string value such as found, ignored, added, removed, playing, suspend, emptied, or ended.</dd><dt>getstyle</dt><dd>function to call in lieu of window.getComputedStyle on a video object in strict mode.</dd></dl><span>Following optional parameters are common across most tabs.</span><dl><dt>global</dt><dd>an object representing global data useful in strict mode.</dd><dt>console</dt><dd>an object in lieu of window.console for logging in strict mode.</dd><dt>location</dt><dd>an object in lieu of window.location for accessing web page URL in strict mode.</dd><dt>controls</dt><dd>an object to access shared variables with the controls tab.</dd></dl></div></div></div><div class="tab"tab="mediastream"name="Stream"><div class="help"><div class="title">Customize media streams in capture, or receive</div><div class="desc"><span>It allows intercepting and modifying any media stream created using getUserMedia, getDisplayMedia, or captureStream, or received on a peer connection in its ontrack event. The function defined below is called for each such instance. It can intercept changes to the media stream and included media tracks. Because of the underlying implementation, the function may be async only for getUserMedia or getDisplayMedia use cases, but not for others. These optional named parameters are allowed.</span><dl><dt>stream</dt><dd>the media stream object containing zero or more media tracks, or a track object if a streamless track is received.</dd><dt>context</dt><dd>a string representing the intercepted function such as getUserMedia, getDisplayMedia, captureStream, or ontrack.</dd></dl><span>Following optional parameters are common across most tabs.</span><dl><dt>global</dt><dd>an object representing global data useful in strict mode.</dd><dt>console</dt><dd>an object in lieu of window.console for logging in strict mode.</dd><dt>location</dt><dd>an object in lieu of window.location for accessing web page URL in strict mode.</dd><dt>controls</dt><dd>an object to access shared variables with the controls tab.</dd></dl></div></div></div><div class="tab"tab="devicelist"name="Devices"><div class="help"><div class="title">Customize list of available webcam, microphone and speaker devices</div><div class="desc"><span>It allows intercepting and modifying the list of devices returned by any enumerateDevices call, and altering the list devices shown by the application. The function defined below is called to intercept the enumerateDevices calls, and to alter the list of devices returned. The function must return the new list of devices. The function may be async. These optional named parameters are allowed.</span><dl><dt>devices</dt><dd>list returned by an internal call to enumerateDevices.</dd></dl><span>Following optional parameters are common across most tabs.</span><dl><dt>global</dt><dd>an object representing global data useful in strict mode.</dd><dt>console</dt><dd>an object in lieu of window.console for logging in strict mode.</dd><dt>location</dt><dd>an object in lieu of window.location for accessing web page URL in strict mode.</dd><dt>controls</dt><dd>an object to access shared variables with the controls tab.</dd></dl></div></div></div><div class="tab"tab="usermedia"name="Media"><div class="help"><div class="title">Customize user media constraints such as frame rate, width and height</div><div class="desc"><span>It allows intercepting and modifying the constraints supplied to any getUserMedia and applyConstraints calls. The function defined below is called to intercept the getUserMedia and applyConstraints calls, and to alter the supplied constraints. The function can modify the supplied constraints object or return a new constraints object. The function may be async. These optional named parameters are allowed.</span><dl><dt>constraints</dt><dd>the object that was supplied to the intercepted function as constraints.</dd><dt>context</dt><dd>a string representing the intercepted function such as getUserMedia or applyConstraints.</dd></dl><span>Following optional parameters are common across most tabs.</span><dl><dt>global</dt><dd>an object representing global data useful in strict mode.</dd><dt>console</dt><dd>an object in lieu of window.console for logging in strict mode.</dd><dt>location</dt><dd>an object in lieu of window.location for accessing web page URL in strict mode.</dd><dt>controls</dt><dd>an object to access shared variables with the controls tab.</dd></dl></div></div></div><div class="tab"tab="mediacodec"name="Session"><div class="help"><div class="title">Customize session description attributes such as codec and bandwidth</div><div class="desc"><span>It allows intercepting and modifying various methods related to media session in any RTCPeerConnection object. The function defined below is called to intercept the session description objects in the createOffer, createAnswer, setLocalDescription and setRemoteDescription methods of any RTCPeerConnection object. The function may be async, in which case the intercepted function awaits its completion. The function may return the new or modified session object, or may alter the supplied session object. These optional named parameters are allowed.</span><dl><dt>id</dt><dd>a unique string representing the underlying peer connection.</dd><dt>connection</dt><dd>the underlying RTCPeerConnection instance used internally.</dd><dt>session</dt><dd>the offer or answer object of type RTCSessionDescription associated with the intercepted function.</dd><dt>context</dt><dd>a string representing the intercepted function such as createOfferOnSuccess, createAnswerOnSuccess, setLocalDescription or setRemoteDescription.</dd><dt>data</dt><dd>an state object assigned to the peer connection.</dd></dl><span>Following optional parameters are common across most tabs.</span><dl><dt>global</dt><dd>an object representing global data useful in strict mode.</dd><dt>console</dt><dd>an object in lieu of window.console for logging in strict mode.</dd><dt>location</dt><dd>an object in lieu of window.location for accessing web page URL in strict mode.</dd><dt>controls</dt><dd>an object to access shared variables with the controls tab.</dd></dl></div></div></div><div class="tab"tab="mediaconnect"name="Connect"noasync><div class="help"><div class="title">Customize connection attributes such as ICE servers and DSCP</div><div class="desc"><span>It allows intercepting and modifying any call to construct a new RTCPeerConnection. The function defined below is called to intercept the constructor of RTCPeerConnection, and to alter the supplied configuration and constraints. The function can modify the supplied configuration or return the new configuration. The function can also modify the supplied constraints. The function must not be async. These optional named parameters are allowed.</span><dl><dt>id</dt><dd>a unique string representing the peer connection.</dd><dt>config</dt><dd>the object supplied to the intercepted constructor function as configuration.</dd><dt>configuration</dt><dd>same as config above.</dd><dt>constraints</dt><dd>the object supplied to the intercepted constructor function as optional constraints.</dd><dt>data</dt><dd>an state object assigned to the peer connection.</dd></dl><span>Following optional parameters are common across most tabs.</span><dl><dt>global</dt><dd>an object representing global data useful in strict mode.</dd><dt>console</dt><dd>an object in lieu of window.console for logging in strict mode.</dd><dt>location</dt><dd>an object in lieu of window.location for accessing web page URL in strict mode.</dd><dt>controls</dt><dd>an object to access shared variables with the controls tab.</dd></dl></div></div></div><div class="tab"tab="medianetwork"name="Network"noasync><div class="help"><div class="title">Customize transport parameters such as ICE candidates</div><div class="desc"><span>It allows intercepting and modifying various method and events related to network connection in any RTCPeerConnection object. The function defined below is called to intercept the ICECandidate objects in the icecandidate event and the addIceCandidate method of any RTCPeerConnection object. The function may modify the supplied candidate or return the new candidate. If the return value is null, then the supplied candidate is not used and is filtered out. The function must not be async. These optional named parameters are allowed.</span><dl><dt>id</dt><dd>a unique string representing the underlying peer connection.</dd><dt>connection</dt><dd>the underlying RTCPeerConnection instance used internally.</dd><dt>candidate</dt><dd>the object of type RTCCandidate associated with the intercepted function or event.<dt>context</dt></dd><dd>a string representing the intercepted function or event such as icecandidate or addIceCandidate.</dd></dl><span>Following optional parameters are common across most tabs.</span><dl><dt>data</dt><dd>an state object assigned to the peer connection.</dd><dt>global</dt><dd>an object representing global data useful in strict mode.</dd><dt>console</dt><dd>an object in lieu of window.console for logging in strict mode.</dd><dt>location</dt><dd>an object in lieu of window.location for accessing web page URL in strict mode.</dd><dt>controls</dt><dd>an object to access shared variables with the controls tab.</dd></dl></div></div></div><div class="tab"tab="mediastats"name="Stats"><div class="help"><div class="title">Capture quality stats and metrics and store for future analysis</div><div class="desc"><span>It allows intercepting and modifying the getStats call in any RTPPeerConnection object. The function defined below is called periodically to capture and analyze the statistics data returned by getStats on any RTCPeerConnection object. In addition, it also intercepts any other other methods and events, for logging or other purpose. The function may be async. These optional named parameters are allowed.</span><dl><dt>id</dt><dd>a unique string representing the underlying peer connection.</dd><dt>connection</dt><dd>the underlying RTCPeerConnection instance used internally.</dd><dt>type</dt><dd>a string indicating either method or event.</dd><dt>name</dt><dd>a string with method or event name such as setLocalDescription or icecandidate.</dd><dt>args</dt><dd>a list of arguments to the intercepted method or event.</dd><dt>data</dt><dd>an state object assigned to the peer connection.</dd><dt>videos</dt><dd>an array of all the &lt;video&gt; elements on the page.</dd><dt>parsequery</dt><dd>a convenience function that can be used to parse SQL-like query on getStats result.</dd><dt>query</dt><dd>a convenience function that can be used to perform SQL-like query on getStats result.</dd><dt>plot</dt><dd>a function that plots graph in local display panel, e.g., using metrics derived from getStats result.</dd><dt>compress</dt><dd>a function that can be used to compress the getStats result.</dd><dt>send</dt><dd>a function to send the compressed stats to the default or configured monitoring service.</dd></dl><span>Following optional parameters are common across most tabs.</span><dl><dt>global</dt><dd>an object representing global data useful in strict mode.</dd><dt>console</dt><dd>an object in lieu of window.console for logging in strict mode.</dd><dt>location</dt><dd>an object in lieu of window.location for accessing web page URL in strict mode.</dd><dt>controls</dt><dd>an object to access shared variables with the controls tab.</dd></dl></div></div></div><div class="tab"tab="datachannel"name="Data"noasync><div class="help"><div class="title">Customize data channel behavior</div><div class="desc"><span>It allows intercepting and modifying various methods and events on any data channel. The function defined below is called for various data channel related method and events to intercept and alter the behavior. The function must not be async. These optional named parameters are allowed.</span><dl><dt>id</dt><dd>a unique string representing the underlying peer connection.</dd><dt>connection</dt><dd>the underlying RTCPeerConnection instance used internally.</dd><dt>type</dt><dd>a string indicating method, event, RTCDataChannel.method or RTCDataChannel.event.</dd><dt>context</dt><dd>a string representing the intercepted function or event.</dd><dt>channel</dt><dd>the underlying RTCDataChannel object.</dd><dt>args</dt><dd>a list of arguments to the intercepted method or event.</dd><dt>data</dt><dd>an state object assigned to the peer connection.</dd></dl><span>Following optional parameters are common across most tabs.</span><dl><dt>global</dt><dd>an object representing global data useful in strict mode.</dd><dt>console</dt><dd>an object in lieu of window.console for logging in strict mode.</dd><dt>location</dt><dd>an object in lieu of window.location for accessing web page URL in strict mode.</dd><dt>controls</dt><dd>an object to access shared variables with the controls tab.</dd></dl></div></div></div><div class="tab"tab="websocket"name="Socket"><div class="help"><div class="title">Customize WebSocket behavior</div><div class="desc"><span>It allows intercepting and modifying various methods and events on any WebSocket object. The function defined below is called for various WebSocket related method and events to intercept and alter the behavior. These optional named parameters are allowed.</span><dl><dt>socket</dt><dd>the underlying WebSocket instance used internally.</dd><dt>type</dt><dd>a string indicating method or event.</dd><dt>context</dt><dd>a string representing the intercepted function or event, with special values of preconstruct and construct.</dd><dt>args</dt><dd>a list of arguments to the intercepted method or event.</dd><dt>data</dt><dd>an state object assigned to the WebSocket.</dd></dl><span>Following optional parameters are common across most tabs.</span><dl><dt>global</dt><dd>an object representing global data useful in strict mode.</dd><dt>console</dt><dd>an object in lieu of window.console for logging in strict mode.</dd><dt>location</dt><dd>an object in lieu of window.location for accessing web page URL in strict mode.</dd><dt>controls</dt><dd>an object to access shared variables with the controls tab.</dd></dl></div></div></div><div class="tab"tab="webrequest"name="Request"><div class="help"><div class="title">Customize XMLHttpRequest and fetch behavior</div><div class="desc"><span>It allows intercepting and modifying various methods and events on the any Ajax request and their responses. The function defined below is called for various Ajax related method and events to intercept and alter the behavior. In the intercepting function for request or response, removing the arguments from the args list suppresses the request or response, modifying the args list item can affect the next behavior, returning from the function can return a success response, and throwing an error can return an error response. Additionally, calling the resolve or reject function with the right parameter, causes the related request or response to skip further processing and return the success or error response, respectively. These optional named parameters are allowed.</span><dl><dt>context</dt><dd>a string representing the intercepted function or event; and is one of fetch, fetchresponse or fetcherror when intercepting fetch, or one of open, send or readystatechange when intercepting XMLHttpRequest.</dd><dt>args</dt><dd>a list of arguments to the intercepted method or event.</dd><dt>xhr</dt><dd>optional underlying XMLHTTPRequest instance used internally. If this is undefined, then it is a fetch request.</dd><dt>resolve</dt><dd>function to call to immediately return a success response object.</dd><dt>reject</dt><dd>function to call to immediately return an error response object.</dd><dt>data</dt><dd>an state object assigned to the request and reused in response.</dd></dl><span>Following optional parameters are common across most tabs.</span><dl><dt>global</dt><dd>an object representing global data useful in strict mode.</dd><dt>console</dt><dd>an object in lieu of window.console for logging in strict mode.</dd><dt>location</dt><dd>an object in lieu of window.location for accessing web page URL in strict mode.</dd><dt>controls</dt><dd>an object to access shared variables with the controls tab.</dd></dl></div></div></div><div class="tab"tab="pagesecurity"name="Security"hide="inline"noasync><div class="help"><div class="title">Intercept and customize web requests and responses</div><div class="desc"><span>It allows intercepting and modifying any web request or response headers by the browser; but this customization is only available in the browser extension using the older manifest version 2, and it does not work with version 3. In the version 3 browser extension, any x-frame-origin and content-security-policy are removed from the web response headers. In version 2, the function defined below is called for every web request, to intercept and alter the behavior. Common customizations include the ability to alter or relax the content-security-policy, e.g., to load certain JavaScript libraries used in the functions defined in other tabs. The function takes one argument, details, which contains all the web request and response details, and is invoked on headers received. The function must not be async. Note that this function is not related to real-time communication feature, but just to the regular web requests.</span></div></div></div><div class="tab"tab="cpuperformance"name="CPU"hide="inline"noasync><div class="help"><div class="title">Customize based on CPU performance</div><div class="desc"><span>It allows customization based on CPU utilization; but this customization is only available in the browser extension, not when used as a wrapper or script in the web application. If enabled, it periodically captures the CPU usage metrics, and allows customization in the application based on that. Note that this function is not related to real-time communication feature, but just to the underlying machine performance.</span></div></div></div><div class="tab static last"name="Control"tab="usercontrols"><button class="save"title="Save and apply the changes. Press ctrl+S or cmd+S"></button><h2>User Controls</h2><label>Define user controllable variables to be used in other functions. You can access them as <code>controls.get("varname")</code>, <code>controls.set("varname", ...)</code> or <code>controls.on("varname", value => {...})</code> in other functions.</label><div></div><div class="variables"><div class="item add"><input name="varname"type="text"placeholder="var name, e.g., var_1"pattern="[a-zA-Z][a-zA-Z0-9_]*"autocomplete="off"title="name must start with alphabet, followed by zero or more alphanumeric or underscore characters."> <select name="type"><option>string</option><option>number</option><option>range</option><option>boolean</option><option>selection</option><option>event</option></select> <input name="pattern"list="patterns"placeholder="pattern, e.g., \w+"autocomplete="off"title="pattern is a javascript regular expression (optional) for string or number, range expression (required) for range, and alternate values (required) for boolean or selection."><datalist id="patterns"><option value="\d+">positive integer</option><option value="\-?\d+(\.\d+)?">any number</option><option value="true|false">boolean</option><option value="first|second|third">selection</option><option value="0-100">min-max range</option><option value="-100-100/10">min-max/step</option></datalist><input name="readonly"type="checkbox"title="controls tab will not allow change in this variable."><label>read-only?</label> <input name="label"type="text"placeholder="description"autocomplete="off"title="use this optional text as tooltip on the variable value box when added to the list below."><div class="flex"></div><button class="add"title="click to insert the variable in the list below.">+ Add</button></div></div></div><div class="tab static"name="Settings"tab="settings"><div class="buttons"><button class="reset"title="Reset to default">Reset</button> <button class="save"title="Save and apply the changes. Press ctrl+S or cmd+S"></button></div><h2>RTC Helper Settings</h2><label>When shown in the browser extension, these settings are globally applied to all the domains. Without the browser extension, some of the settings may be required by the embedding web page e.g., using the <code>?required=mode:inline|theme:light</code> or similar parameter. In that case, any change in those settings are disabled here. Please reload your web page after making and saving any changes here to see the effect.</label><h3>Display Theme</h3><label>The options panel uses light or dark color theme based on the system default. Web page can specify the behavior, e.g., using the <code>?theme=dark</code> or <code>?settings=theme:dark</code> parameter in the script source URL. You can override the behavior by making a selection below.</label><div></div><div class="item"name="theme"><input class="theme"value="light"type="checkbox"> <label>Light</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input class="theme"value="dark"type="checkbox"> <label>Dark</label></div><h3>Display Layout</h3><label>The options panel can appear inline as an iframe or in a separate open window. Web page can specify the behavior, e.g., using the <code>?mode=inline</code> or <code>?settings=theme:dark</code> parameter in the script source URL. You can override the behavior by making a selection below.</label><div></div><div class="item"name="mode"><label>Open this panel in</label> <input class="mode"value="open"type="checkbox"> <label>an external window</label> <input class="mode"value="open-pinned"type="checkbox"hide="noext"> <label hide="noext">with pinned tab or</label> <input class="mode"value="open-popup"type="checkbox"hide="noext"> <label hide="noext">popup window, or as</label> <input class="mode"value="inline"type="checkbox"> <label>an inline iframe</label> <input class="mode"value="inline-float"type="checkbox"> <label>with floating display.</label><br><label>Inline location of right (default),</label> <label>or left</label> <input class="mode-suffix"value="left"type="checkbox"> <label>or bottom</label> <input class="mode-suffix"value="bottom"type="checkbox"></div><h3>Display Tabs</h3><label>Enter a list of comma separated tabs to show in that order. Default with empty box shows all the tabs in their default order. Note that the settings tab cannot be hidden.</label><div class="textarea"name="tabslist"><textarea class="tabslist"spellcheck="false"placeholder="e.g., Capture,Videos,Stats,Help"></textarea></div><div class="item"name="tabswrap"><input class="tabswrap"value="true"type="checkbox"> <label>Wrap tabs in header instead of scroll</label></div><h3>Font Size</h3><label>Select small (default), medium or large font size for readability.</label><div class="select"name="fontsize"><select class="fontsize"><option>small</option><option>medium</option><option>large</option></select></div><h3>Code Editor</h3><label>The code editor in various tabs can be configured to change the default behavior.</label><div></div><div class="item"name="editor"><input class="editor"value="wrap"type="checkbox"checked="checked"title="wrap long lines"> <label>wrap</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input class="editor"value="highlightline"type="checkbox"title="highlight selected line"> <label>select line</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input class="editor"value="highlightword"type="checkbox"title="highlight selected word"> <label>select word</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input class="editor"value="indentguide"type="checkbox"checked="checked"title="show indent guides"> <label>indent guide</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input class="editor"value="invisibles"type="checkbox"title="show invisible characters"> <label>invisibles</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<br><input class="editor"value="foldcomment"type="checkbox"checked="checked"title="fold all block comments"> <label>fold comment</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</div><h3>Edit and Save</h3><label>Configure to allow script editing and saving named scripts. If the edit scripts option is checked, then it allows editing and saves the edits locally. If the save named scripts option is checked then it allows keeping named copies of various edits to allow experimentation. Note that edit scripts is required to enable save named scripts.</label><div></div><div class="item"name="scripts"><input class="scripts"value="edit"type="checkbox"checked="checked"> <label>Edit scripts.</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input class="scripts"value="named"type="checkbox"> <label>Save named scripts.</label></div><h3>External Scripts</h3><label>Enter list of https URLs, one per line, to download the files containing the additional scripts for various tabs here. Once loaded, these scripts appear in dropdowns of other tabs, as applicable.</label><div class="textarea"name="urls"><textarea class="urls"spellcheck="false"placeholder="e.g., https://my-server.com/path/to/file.js&#10;https://another-server/path/to/another-file.js"></textarea></div><h3>Strict Mode</h3><label>Using strict mode prevents access to globals and other data in the functions used in various tabs. This is useful if you do not trust the source of those functions or if the function definitions are minified to hide its behavior. You do not need strict mode if you can visually inspect the function definition and find no malicious usage.</label><div></div><div class="item"name="strict"><input class="strict"value="always"type="checkbox"> <label>All scripts</label>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <input class="strict"value="external"type="checkbox"style="display:none"> <label style="display:none">Only external scripts</label></div><h3>Stats Capture</h3><label>To store compressed <code>getStats</code> data, the stats tab uses an external service over HTTP POST or websocket. By default it assumes the service running on localhost. You can specify the actual third-party URLs for storage and display of the statistics data. The first line for storage should be a web (http or https) or websocket (ws or wss) URL, and the second line for display should be a web (http or https) URL. The sid or store id is randomly generated everytime the app loads, and allows separating the statistics data of different loads.</label><div class="textarea"name="savestats"><textarea class="savestats"spellcheck="false"placeholder="e.g., ws://localhost:9080/publish?sid={{sid}}&#10;http://localhost:9000/index.html?sid={{sid}}"></textarea></div><h3>MP4 Conversion</h3><label>For converting the recorded video to MP4 format, the following ffmpeg command is run, e.g., to transcode video from default h264 to mpeg4. You can change the command to avoid transcoding, e.g., by using copy and removing the target bitrate.</label><div class="textarea"name="ffmpeg"><textarea class="ffmpeg"spellcheck="false"placeholder="e.g., -c:v mpeg4 -b:v 6400k -strict experimental"></textarea></div></div><div class="tab static"name="Help"tab="help"><button class="help"title="Open the project website in a separate tab"></button><h2>What is RTC Helper?</h2><h2 print-only print>Introduction</h2><label print>The <em>RTC Helper</em> software facilitates testing and debugging WebRTC-based applications in the browser by web developers. It can also provide the end user control over various multimedia features such as background blur, media recording or bandwidth management, independent of the application provider's web app. When used as a browser extension, it allows the end user to analyze, customize and improve any audio/video communication on third-party websites that use WebRTC. When integrated in the developer's own web application, it allows the developer to quickly experiment with new ideas such as a new virtual background implementation, or adjustment to video encoder parameters for better quality.<br><br>At the core, this software can selectively intercept certain WebRTC and related APIs such as <code>getUserMedia</code>, <code>RTCPeerConnection</code> and <code>WebSocket</code>, and can inject some code to alter their behavior in real-time. It can also intercepts any video elements added to the web page to allow dynamically changing the user interface of the video conferencing layout, or to provide other advanced features.<br><br></label> <label print-only print>This allows developers (or users) to customize media streams, video elements, screen sharing, data channel, signaling channel, and quality metrics, among others. Some examples of media stream customization are: replacing webcam video track with other generated content, adding watermark or logo on screen sharing, including local webcam feed in shared screen. Video elements customization allows the user to change the layout of the videos, record the displayed videos, or popout the videos in a separate window. There are many more customizations possible, as discussed in this document.<br><br><b>Objectives:</b> Two main goals of this RTC Helper project are: (1) to allow end-user customization of WebRTC experience, without depending on the features provided or supported by the third-party websites, and (2) to allow developers to rapidly create proof-of-concept (PoC) of innovative ideas and emerging features built on top of WebRTC.<br><br>Please see our research paper<a href="https://doi.org/10.48550/arXiv.2512.23688"target="_blank"><sup style="font-size:9px">1</sup></a> for this project's motivation, background, related work, and an overview of its software architecture.<div class="footnote"style="position:absolute;top:calc(200% - 50px);left:0"><sup>1</sup>Unlocking WebRTC for End User Driven Innovation, https://doi.org/10.48550/arXiv.2512.23688</div></label> <button class="print"title="Open printable view of the complete documentation including all the available functions, and save as PDF with 100+ pages.">Print</button><h3 print-only print>Software Architecture</h3><label print-only print>The software architecture below shows an API intercept layer commonly implemented in web frameworks and tools. Instead of providing a generic but complex intercept process, our software exposes a developer friendly layer for commonly found WebRTC related use cases, divided into more than ten categories or tabs. For example, both the Capture and Media tabs work with the <code>getUserMedia</code> API, but the former allows you to customize the video frames captured from the webcam, where as the latter can modify the media constraints, such as to select a specific webcam or disable microphone.<br><br></label> <img print-only print src="../res/architecture.svg"style="max-width:60%;margin-left:20%"> <label print-only print><br><br>The intercept layer in each category can accept a user or developer supplied function in JavaScript. If provided, the function can alter the default behavior of APIs in that category. We have made available numerous such functions for various examples of customization. But more importantly, you can edit or create your own customization function. And in the future, can share those with other developers, or discover and use functions created by other developers.<br><br>As an example, when the web application calls the <code>getUserMedia</code> API, this software intercepts it, and prompts the user to customize the behavior. If the user selects to customize, the Capture tab is opened, which allows changing the behavior. If the user declines to customize, the web application proceeds with normal behavior of that API.<br></label> <img print-only print src="../res/intercept.svg"style="max-width:80%;margin-left:10%"> <label print-only print><br>The diagram aboves shows the various places in WebRTC and related APIs that are intercepted. The topics mentioned in the diagram in red and italic font represent the various intercept and customization points in this software. For example, the <em>Connect</em> category deals with constructing a new <code>RTCPeerConnection</code> object, whereas <em>Network</em> deals with outgoing and incoming ICE candidates on the peer connection. While <em>Media</em> deals with intercept of constraints on <code>getUserMedia</code> and <code>applyConstraints</code> APIs, the <em>Capture</em> and <em>Screen</em> categories allow customizing the actual track content by drawing on a canvas.<br><br>These topics are further explained later with several examples of the customization functions.</label><h2>How do I use this?</h2><h2 print-only print>Using the Tool</h2><label print>There are generally three ways to use this software:<ol class="nolink"><li>Any user can install and enable this to test and debug any third-party website using a Google Chrome-compatible browser extension. The browser extension intercepts and applies the features of this software to all the web pages you visit. For privacy reason or to avoid interfering with your regular browsing behavior, it is recommended to use a separate browser persona to enable this extension for web development, testing and debugging effort.</li><li>As a web developer, you can include this software in your WebRTC enabled website, to make this available to your web app users. You do this using the the &lt;script&gt; tag in your web pages. In this mode all the features in this software are directly available to your web app users, and can be enabled by the end user by clicking on an easter-egg button.</li><li>As a web developer, you can include some parts of this software via the &lt;script&gt; tag, and enable them programmatically and selectively to your end users, e.g., virtual background or media recording. In this mode, only selected features of this software are enabled for your users, and must be triggered programmatically via your app logic.</li></ol></label> <label print-only print><p>Further details on how to accomplish these alternatives are as follows.</p><img src="../res/install1.png"style="max-width:100%"><p>1. To install as a browser extension, either download the extension from the Chrome web store, or for more up-to-date version, follow the steps in the diagram above - download the <a href="../../rtchelper.zip">ZIP file</a>, unzip it in a folder, open chrome://extensions, enable developer mode, and click to load the unpacked extension from the unzipped folder. After that you will notice the new extension in the toolbar, and you can pin the extension to be always visible. Once installed, open the included <a href="../../test/extension.html"target="_blank">extension.html</a> test webpage to test.</p><p>2. To make it available for all users of your website, include the following two scripts in your main HTML file. This creates a hidden button of size 6x6 pixels at the top-right corner of the web page, which when clicked opens the panel for this software.</p><pre><code class="language-html">&lt;script type="text/javascript" src="dist/js/inject.js"&gt;&lt;/script&gt;
&lt;script type="text/javascript" src="dist/js/wrapper.js"&gt;&lt;/script&gt;</code></pre><p>Additionally, you can pass certain configurations to the second script to customize the behavior. The following example disables any user driven change in display theme or edit scripts configuration, and makes the default display mode of inline. The actual list of customizable settings is described later or can also be inferred by inspecting the settings panel.</p><pre><code class="language-js">src="dist/js/wrapper.js?required=theme:|scripts:&settings=mode:inline"</code></pre><p>You can also open and analyze the included <a href="../../test/wrapper.html"target="_blank">wrapper.html</a> test webpage that uses this approach.</p><p>3. To selectively use some features of this software, include the one script in your main HTML file, and then programmatically invoke the feature. This avoids creating any hidden button or including any user interface panel of this software. Note that the scripts in head and body should be included before any other scripts that may alter the WebRTC API behavior. The following example shows that the webcam capture API, videocapture, is intercepted to replace the captured stream with the supplied app logic, which can add an overlay icon as an example.</p><pre><code class="language-html">&lt;head&gt;
    &lt;script type="text/javascript" src="dist/js/inject.js"&gt;&lt;/script&gt;
    ...
&lt;/head&gt;
&lt;body&gt;
    &lt;script type="text/javascript"&gt;
        const videocapture = (function(canvas,video) {
            ... // draw on canvas using video and some icon image
        }).toString();

        _rtchelper_content(undefined, undefined, "dist/res");
        _rtchelper_setprocess("videocapture", videocapture);
    &lt;/script&gt;
    ...
&lt;/body&gt;</code></pre><p>You can also open and analyze the included <a href="../../test/script.html"target="_blank">script.html</a> test webpage that uses this approach.</p></label><h3 print-only print>Settings</h3><label print-only print>Here is the list of customizable settings.<br><br><b>theme</b> - allowed values are light or dark, and defaults to using the underlying browser or system settings.<br><br><b>mode</b> - allowed values are open, inline, open-pinned, open-popup or inline-float, and defaults to open. These values control how the panel is opened - in an external browser tab, in an external tab which is pinned, in an external popup window, as an inline iframe within the web page on the side, or as an inline iframe floating from the side - respectively. For inline or inline-float, optional suffix of :left or :bottom may be present to determine the location of the panel, such as inline-float:left. The location defaults to right.<br><br><b>tabslist</b> - controls which tabs in the panel are shown, and includes comma separated list of one or more from Capture, Screen, Record, Videos, Stream, Devices, Media, Connect, Session, Network, Stats, Data, Socket, Request, Control, Settings, Help. It also controls the order in which these tabs are included in the panel.<br><br><b>tabswrap</b> - controls whether the displayed tabs in the header for navigation are wrapped or scrolled. Allowed values are true (wrap) or false (scroll).<br><br><b>fontsize</b> - controls the fontsize to use as one of small, medium or large. Default is to use small, which appears similar to the browser devtools.<br><br><b>editor</b> - controls the behavior and appearance of the code editor, and includes comma separated list of one or more of these attributes in their positive or negative form: wrap, highlightline, highlightword, indentguide, invisibles, foldcomment. These values control - wrap long lines, highlight selected line, highlight selected word, show indent guides, show invisible characters, fold all block comments - respectively. A negative form is just the value with a no prefix, e.g., nowrap. The default behavior assumes wrap, nohighlightline, nohighlightword, indentguide, noinvisibles, foldcomment.<br><br><b>scripts</b> - allowed values are noedit or named, with default behavior as edit. It controls whether script editing is allowed, and in addition to editing, whether saving the script as named script is allowed. Without named scripts, only one active script is saved per panel. With named scripts, you can experiment with multiple scripts and quickly switch among them.<br><br><b>urls</b> - list of https URLs, one per line, to download the files containing the additional scripts for various tabs. Once loaded these scripts appear in the dropdowns of the panel tabs as applicable. The file must be in JSON format with appropriate objects and attributes to populate various tabs' list of example scripts.<br><br><b>strict</b> - allowed values are always or external, with default as no strict mode. Using the strict mode prevents access to globals and other data in the customizable functions used in various tabs. This is useful if you do not trust the source of those functions or if the function definitions are minified to hide its behavior. You do not need strict mode if these functions are written by you or trusted source, or if you can visually inspect the function definition and find no malicious usage.<br><br><b>savestats</b> - to store compressed statistics data, the stats tab uses an external service over HTTP POST or websocket. By default it assumes the service running on localhost. You can specify the actual third-party URLs for storage and display of the statistics data. The first line for storage should be a web (http or https) or websocket (ws or wss) URL, and the second line for display should be a web (http or https) URL.<br><br><b>ffmpeg</b> - for converting the recorded video to MP4 format, a specific ffmpeg command is run, such as to transcode video from the default h264 to mpeg4. You can change the command to avoid transcoding, if your player is able to play h264 encoded mp4 format.</label><h3 print-only print>User Interface</h3><label print-only print><p>Some example user interface of the software is shown below. The first screen is the options panel opened in a new window, showing the website selection on the left, and the customization tabs on the right. The second screen has the options panel opened inline on the side, and shows our included test page with customized webcam capture.</p><img src="../res/options-tab.png"style="max-width:48%;border:solid 1px grey;display:inline-block"> <img src="../res/options-side.png"style="max-width:48%;border:solid 1px grey;display:inline-block"></label><h2>What are the main topics?</h2><label>Click on an available topic listed below, to select the right tab.</label><ol class="topics"></ol><span print-only print><br>The following diagram shows again the various places in the WebRTC and related APIs where these customization categories are applied.<br><img src="../res/intercept.svg"><br></span><span print>The various customization categories or tabs are summarized below.</span><table class="topicdesc"print><thead><tr><td>Tab</td><td>Summary</td></tr></thead><tbody></tbody></table><h2>How do I do this or that?</h2><label>Click on an available feature listed below, to select it in the right tab. The changes are not applied until you click to save in that tab.</label><ol class="features"></ol><h2 later print-only print>How do I extend this to include that?</h2><label print-only print>On the settings tab, you can specify a list of https URLs, which are used by this software to download external customization functions. These external functions are then added to the list of pre-loaded functions in various tabs as applicable. This allows you to extend the existing list of functions available to the user. This can be done both by the end user when this software is used as a browser extension, or by the web developer when this software is integrated in the website.<br><br>Each external URL should allow downloading a text file with content in JSON format, that specify one or more customization function in one or more categories. An example is shown below, that includes a function in the <em>capture</em> category, and two functions in the <em>connect</em> category. The text for the function definition is snipped for brevity, but should follow the signature, conventions and examples shown earlier in various customization categories. Note that the function definition is included as a string, can have escaped new-line or other characters, and should be parseable by a JSON parser.<br><pre><code class="language-js">{
    "videocapture": {
        "Testing - my new background blur": 
            "function(canvas,video,data,segment) {\n ... \n}"
    },
    "mediaconnect": {
        "Test1 - remove any media relay": 
            "function(config) {\n ... \n}",
        "Test2 - remove any optional constraints": 
            "function(config, constraints) {\n ... \n}",
    },
}</code></pre><br>Alternatively, instead of using a strict JSON format, it can be a text file with some function definitions and preceding comment containing the metadata as shown below.<pre><code class="language-js">//@tab Capture: Testing - my new background blur
function (canvas, video, data, segment) {
    ...
}

//@tab Connect: Test1 - remove any media relay
function (config) {
    ...
}

//@tab Connect: Test2 - remove any optional constraints
function (config, constraints) {
    ...
}</code></pre><br>This format is easier to read, but certain convention must be followed strictly for correct parsing. Any line must start with either an empty space or tab character, or one of this strings: <code>//@tab</code>, or <code>function</code>, or <code>async function</code>, or closing curly brace indicating end of function, i.e., <code>&rcub;</code>, without any other character on that line.</label></div></div></body></html>
